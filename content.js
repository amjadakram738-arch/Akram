var l=Object.defineProperty;var r=(s,t,e)=>t in s?l(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var i=(s,t,e)=>r(s,typeof t!="symbol"?t+"":t,e);class a{constructor(){i(this,"container");i(this,"subtitle");i(this,"isDragging",!1);i(this,"dragOffset",{x:0,y:0});this.container=this.createContainer(),this.subtitle=this.createSubtitle()}createContainer(){const t=document.createElement("div");return t.id="vt-subtitle-container",t.className="vt-subtitle-container",t.style.position="fixed",t.style.zIndex="2147483647",t.style.pointerEvents="none",t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0",t}createSubtitle(){const t=document.createElement("div");return t.className="vt-subtitle",t.style.position="absolute",t.style.pointerEvents="auto",t.style.cursor="move",t.style.padding="8px 16px",t.style.borderRadius="4px",t.style.textAlign="center",t.style.transition="font-size 0.2s, background-color 0.2s",this.container.appendChild(t),t}updateSubtitle(t,e){this.subtitle.textContent=t,this.applyStyles(e)}applyStyles(t){const e=this.subtitle.style;e.fontSize=`${t.fontSize}px`,e.color=t.fontColor,e.backgroundColor=`rgba(${this.hexToRgb(t.backgroundColor)}, ${t.opacity/100})`,e.fontFamily=t.fontFamily==="sans"?"sans-serif":t.fontFamily==="serif"?"serif":"monospace",e.borderRadius=`${t.borderRadius}px`,t.shadowEnabled?e.textShadow="1px 1px 2px #000":e.textShadow="none",t.position==="top"?(e.top="20px",e.bottom="auto",e.left="50%",e.transform="translateX(-50%)"):t.position==="bottom"?(e.bottom="40px",e.top="auto",e.left="50%",e.transform="translateX(-50%)"):t.position==="center"&&(e.top="50%",e.bottom="auto",e.left="50%",e.transform="translate(-50%, -50%)")}hexToRgb(t){t=t.replace("#","");const e=parseInt(t.substring(0,2),16),o=parseInt(t.substring(2,4),16),n=parseInt(t.substring(4,6),16);return`${e}, ${o}, ${n}`}makeSubtitleDraggable(){this.subtitle.addEventListener("mousedown",t=>{this.isDragging=!0,this.dragOffset.x=t.clientX-this.subtitle.offsetLeft,this.dragOffset.y=t.clientY-this.subtitle.offsetTop,t.preventDefault()}),document.addEventListener("mousemove",t=>{this.isDragging&&(this.subtitle.style.left=`${t.clientX-this.dragOffset.x}px`,this.subtitle.style.top=`${t.clientY-this.dragOffset.y}px`,this.subtitle.style.transform="none",this.subtitle.style.bottom="auto")}),document.addEventListener("mouseup",()=>{this.isDragging=!1})}show(){this.container.style.display="block"}hide(){this.container.style.display="none"}inject(){document.getElementById("vt-subtitle-container")||(document.body.appendChild(this.container),this.makeSubtitleDraggable())}}class c{static detectPlayers(){const t=[];if(document.querySelectorAll("video").forEach(e=>{t.push({type:"html5",element:e})}),this.isYouTube()){const e=document.querySelector("video");e&&t.push({type:"youtube",element:e})}return document.querySelectorAll("iframe").forEach(e=>{t.push({type:"iframe",element:e})}),t}static isYouTube(){return/youtube\.com|youtu\.be/.test(window.location.hostname)}static isVimeo(){return/vimeo\.com/.test(window.location.hostname)}static isNetflix(){return/netflix\.com/.test(window.location.hostname)}}class u{constructor(){i(this,"overlay");i(this,"settings",null);this.overlay=new a,this.init()}async init(){console.log("Video Translator content script initialized"),this.overlay.inject(),chrome.storage.sync.get(null,t=>{this.settings=t}),chrome.runtime.onMessage.addListener((t,e,o)=>{t.type==="UPDATE_SUBTITLE"?this.settings&&this.settings.displaySettings.enabled&&(this.overlay.updateSubtitle(t.text,this.settings.displaySettings),this.overlay.show()):t.type==="SETTINGS_CHANGED"?this.settings=t.settings:t.type==="TOGGLE_SUBTITLES"&&(t.enabled?this.overlay.show():this.overlay.hide())}),setInterval(()=>{c.detectPlayers().length>0},2e3)}}new u;
